{% extends 'base.html' %}
{% load static %}

{% block title %}Crear Solicitud{% endblock %}

{% block extra_css %}
<!-- Librerías para Select2 y DatePicker -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
{% endblock %}

{% block content %}
<div class="">
  <div class="card shadow-lg">
    <div class="card-header bg-dark text-white text-center">
      <h4><i class="fas fa-route"></i> Solicitar Ruta de Acercamiento</h4>
    </div>
    <div class="card-body">

      <!-- Mensajes de error -->
      {% if form.errors %}
      <div class="alert alert-danger">
        <strong>Por favor, corrige los siguientes errores:</strong>
        <ul>
          {% for field, errors in form.errors.items %}
          <li><strong>{{ field }}:</strong> {{ errors.0 }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      {{ form.media }}
      <form method="post" id="solicitud-data-form">
        {% csrf_token %}

          <div class="col-md-6 mb-3">
            <label class="form-label"><i class="fa-solid fa-clock"></i> {{ form.turno.label }}</label>
            <div class="input-group">
              {{ form.turno }}
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label class="form-label"><i class="fa-solid fa-phone"></i> {{ form.telefono.label }}</label>
            <div class="input-group">
              {{ form.telefono }}
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label class="form-label"><i class="fa-solid fa-map-marker-alt"></i> {{ form.direccion.label }}</label>
            <div class="input-group">
              {{ form.direccion }}
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label class="form-label"><i class="fa-regular fa-calendar"></i> {{ form.fecha_recogida.label }}</label>
            <div class="input-group">
              {{ form.fecha_recogida }}
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label class="form-label"><i class="fa-solid fa-city"></i> {{ form.localidad.label }}</label>
            <div class="d-flex align-items-center">
              {{ form.localidad }}
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label class="form-label"><i class="fa-solid fa-house-user"></i> {{ form.barrio.label }}</label>
            <div class="d-flex align-items-center">
              {{ form.barrio }}
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label class="form-label"><i class="fa-solid fa-bus"></i> {{ form.ruta.label }}</label>
            <div class="d-flex align-items-center">
              {{ form.ruta }}
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label class="form-label"><i class="fa-solid fa-map"></i> {{ form.ubicacion.label }}</label>
            <div class="input-group">
              {{ form.ubicacion }}
            </div>
            <div class="mt-2">
              <a href="https://www.google.com/maps" target="_blank" class="btn btn-outline-secondary btn-sm">
                <i class="fas fa-map-marker-alt"></i> Ingresar a Google Maps
              </a>
            </div>
          </div>

          <input type="hidden" name="operador" value="{{ request.user.id }}">

          <div class="row justify-content-center mt-4">
            <div class="col-md-4 d-grid gap-2">
              <button type="submit" class="btn btn-success btn-lg mt-2">
                <i class="fas fa-save"></i> Guardar Registro
              </button>
            </div>
            
            <div class="col-md-4 d-grid gap-2">
              <a href="{% url 'operaciones' %}" class="btn btn-secondary btn-lg mt-2 text-white">
                <i class="fas fa-arrow-left"></i> Volver
              </a>
            </div>
          </div>

        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- Librerías JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

<script>
  $(document).ready(function () {
    // Activar Select2 en los dropdowns
    $('select').select2({
      width: '100%'
    });

    // Activar DatePicker en los campos de fecha
    $('input[type="date"]').datepicker({
      format: 'yyyy-mm-dd',
      autoclose: true
    });
  });
</script>
{% endblock %}